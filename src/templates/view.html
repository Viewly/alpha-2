{% extends 'base.html' %}
{% block title %}{{ video.title }}{% endblock %}

{#{% set autoPlay = 1 %}#}
{#{% set video_id = video.id %}#}
{#{% block player %}#}
{#    <div id="player-full"></div>#}
{#{% endblock %}#}

{% block player %}
    <iframe id="embedded-player"
        width="100%" height="680"
        src="/embed/{{ video.id }}?autoPlay=1"
        frameborder="0" scrolling="0" allowfullscreen>
    </iframe>
{% endblock %}

{% block content %}

    <div style="margin-bottom: 8px;"></div>
    <div class="ui centered divided grid">
        <div class="row">
            <div class="twelve wide column">
                <div class="ui segment">
                    <h2 class="ui left floated header">{{ video.title }}</h2>
                    <div class="uis clearing divider"></div>
                    <div class="ui relaxed divided items">
                        <div class="item">
                            <div class="content">
                                <img src="https://i.imgur.com/32AwiVw.jpg"
                                     class="ui circular avatar image">
                                <b><a href="{{ url_for('view_channel', channel_id=video.channel.id) }}">
                                    {{ video.channel.display_name }}</a></b>
                                published on {{ video.published_at | humanDate }}
                                <br>
                                <br>

                                <div class="description">
                                    <div class="Post">
                                        {% if video.description %}
                                            {{ video.description | markdown }}
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="four wide column">
                <h2>Rewards</h2>
                <a href="javascript:;" class="ui button blue">Vote for this video</a>
                <i class="circular question icon"
                   data-title="Support this creator and earn rewards"
                   data-content="Vote if you like this video, and would like to support the creator who made it.
                   Votes will be tallied up in the upcoming distribution game, and VIEW Token rewards will be distributed to successful creators and curators (voters)."
                   data-variation="large wide"
                   data-position="left center">
                </i>
            </div>
        </div>
    </div>



    {% include 'partials/disqus.html' %}
{% endblock %}

{% block footer %}
    <br>
    {% include 'partials/footer.html' %}
{% endblock %}

{% block scripts %}
    <script type="application/javascript">
        let resizePlayer = function () {
            // let the player take 80% of available screen height
            document.getElementById('embedded-player')
                .setAttribute('height', String(window.innerHeight*0.8));
        };
        window.onload = function() {
            resizePlayer();
        };
        window.addEventListener("resize", function() {
            // todo, use rxjs to only accept last resize
            // event in last 100ms interval
            resizePlayer();
        });
    </script>

    <script type="application/javascript">
        // SEMANTIC.UI
        $(function () {
            $('.circular.question').popup();
        });
    </script>
{% endblock %}

{#{% include 'partials/player_js.html' %}#}